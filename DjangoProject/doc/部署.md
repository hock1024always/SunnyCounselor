# 0 删除
1. 查看进程 `lsof -i :8000`
2. 终止进程 `kill PID`
3. 删除老版本 `rm -rf 文件夹/*`
4. 替换文件 `rm 文件名`

# 1 环境配置
1. 创建虚拟环境   

  - `sudo apt update`

  - `sudo apt install python3 python3-pip python3-venv -y`

  - `python3 -m venv venv`

  - `source venv/bin/activate`

2. 下载依赖 

   - `pip install --upgrade pip`
   - `pip install -r requirements.txt`

# 2 程序部署

**上传时需要包含以下文件和目录：**

- `manage.py` - Django项目管理脚本（必需）
- `requirements.txt` - Python依赖列表（必需）
- `DjangoProject/` - 项目主配置目录（必需）
- `CounselorAdmin/` - 管理员应用目录（必需）
- `Consultant/` - 咨询师应用目录（必需）
- `templates/` - 模板文件目录（如果存在）
- `static/` - 静态文件目录（如果本地已有文件需要上传）

不要上传的东西：

\- `__pycache__/` - Python缓存文件（可忽略）

\- `*.pyc` - Python编译文件（可忽略）

\- `db.sqlite3` - 本地数据库文件（服务器上会创建新的）

\- `.idea/` - IDE配置文件（可忽略）

# 3 程序启动

1. 创建迁移文件（如果还没有）`python manage.py makemigrations`

2. 应用迁移（创建所有数据库表）`python manage.py migrate`

3. 根据项目需求创建静态文件夹

   - 创建static目录（如果不存在）`mkdir -p static`

   - 创建各个上传文件子目录

     - `mkdir -p static/interview_form`

     - `mkdir -p static/referral_image`

     - `mkdir -p static/article_video`

     - `mkdir -p static/banner_photo`

     - `mkdir -p templates`  模板文件目录（已存在可跳过）
     
   - 确保Django进程有写权限）
   
     -  `chmod -R 755 static`
   
     - `chmod -R 755 templates`

4. 临时启动：`python manage.py runserver 0.0.0.0:8000`
5. 测试启动：`nohup python manage.py runserver 0.0.0.0:8000 > django.log 2>&1 &`

# 4 测试数据

1. 基本用法（使用默认值）`python manage.py generate_test_data`
  咨询师ID：2（默认）
  每个表生成：100条数据（默认）

2. 自定义参数

   ```cmd
   # 指定咨询师ID和生成数量
   python manage.py generate_test_data --counselor-id 2 --count 100
   # 只指定生成数量
   python manage.py generate_test_data --count 50
   # 只指定咨询师ID
   python manage.py generate_test_data --counselor-id 2
   ```

   